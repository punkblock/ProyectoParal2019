#include <stdio.h>
#include <string.h>
#include <iostream>
#include <xlnt/xlnt.hpp>
#include "xlsxwriter.h"

using namespace std;

void leer(){
    xlnt::workbook wb;
    wb.load("/home/charls/libxlsxwriter/Horario.xlsx");
    auto ws = wb.active_sheet();
    cout << "Processing spread sheet" << endl;
    for (auto row : ws.rows(false)) 
    { 
        for (auto cell : row) 
    { 
        cout << cell.to_string() << endl;
    }
    }
    cout << "Processing complete" << endl;
}

void crear_hojas(){
	int hoja = 0;
	int bloques = 0;
        lxw_workbook  *workbook  = workbook_new("Horario.xlsx");
	while(hoja<42){
	   hoja++;
	   lxw_worksheet *worksheet = workbook_add_worksheet(workbook, NULL);
	   while(bloques<7){
		bloques++;		
		worksheet_write_string(worksheet,bloques, 0, "Bloques", NULL);
	   }
           bloques = 0;
	   
	   worksheet_write_string(worksheet, 0, 0, "Bloques/Dias", NULL);
	   worksheet_write_string(worksheet, 0, 1, "Lunes", NULL);
   	   worksheet_write_string(worksheet, 0, 2, "Martes", NULL);
	   worksheet_write_string(worksheet, 0, 3, "Miercoles", NULL);
	   worksheet_write_string(worksheet, 0, 4, "Jueves", NULL);
	   worksheet_write_string(worksheet, 0, 5, "Viernes", NULL);	    
	}
	workbook_close(workbook);
}

int main() {

    crear_hojas();
    leer();
    return 0;
}
